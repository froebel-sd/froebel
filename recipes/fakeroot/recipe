pkgname="fakeroot"
pkgver="1.23"
pkgrev="0"
maintainer=""
homepage="https://salsa.debian.org/clint/fakeroot"
desc="provides a fake root environment for building packages"
dependencies="linux-headers musl libcap netbsd-csu"
license=""
src="http://ftp.debian.org/debian/pool/main/f/${pkgname}/${pkgname}_${pkgver}.orig.tar.xz"

builddir="$srcdir"/"$pkgname"-"$pkgver"

do_build() {
    cd "$builddir"

    export CFLAGS="$CFLAGS -fPIC -D_STAT_VER=0 -DSEND_GET_XATTR\(a,b,c\)=send_get_xattr\(a,b\)"
    export LDFLAGS="-fPIC"
    export LD="ld.lld"

    export SED=sed
    export GREP=grep

    ./configure \
        --prefix="" \
        --host="$HOST_TRIPLE" \
        --build="$TARGET_TRIPLE" \
        --with-pic \
        --with-sysroot="$FBUILD_SYSROOT" \

    make
}

do_install() {
    cd "$builddir"

    make DESTDIR="$pkgdir" install
}
